from .ConfigReader import get_app_config

def get_schema():
    schema =  "id string, member_id string, loan_amnt double, funded_amnt double, funded_amnt_inv double, term string, int_rate double, installment double, grade string, sub_grade string, emp_title string, emp_length string, home_ownership string, annual_inc string, verification_status string, issue_d string, loan_status string, pymnt_plan string, url string, desc string, purpose string, title string, zip_code string, addr_state string, dti string, delinq_2yrs string, earliest_cr_line string, fico_range_low string, fico_range_high string, inq_last_6mths string, mths_since_last_delinq string, mths_since_last_record string, open_acc string, pub_rec string, revol_bal string, revol_util string, total_acc string, initial_list_status string, out_prncp string, out_prncp_inv string, total_pymnt string, total_pymnt_inv string, total_rec_prncp string, total_rec_int string, total_rec_late_fee string, recoveries string, collection_recovery_fee string, last_pymnt_d string, last_pymnt_amnt string, next_pymnt_d string, last_credit_pull_d string, last_fico_range_high string, last_fico_range_low string, collections_12_mths_ex_med string, mths_since_last_major_derog string, policy_code string, application_type string, annual_inc_joint string, dti_joint string, verification_status_joint string, acc_now_delinq string, tot_coll_amt string, tot_cur_bal string, open_acc_6m string, open_act_il string, open_il_12m string, open_il_24m string, mths_since_rcnt_il string, total_bal_il string, il_util string, open_rv_12m string, open_rv_24m string, max_bal_bc string, all_util string, total_rev_hi_lim string, inq_fi string, total_cu_tl string, inq_last_12m double, acc_open_past_24mths double, avg_cur_bal string, bc_open_to_buy double, bc_util string, chargeoff_within_12_mths double, delinq_amnt double, mo_sin_old_il_acct double, mo_sin_old_rev_tl_op double, mo_sin_rcnt_rev_tl_op double, mo_sin_rcnt_tl double, mort_acc double, mths_since_recent_bc double, mths_since_recent_bc_dlq double, mths_since_recent_inq double, mths_since_recent_revol_delinq double, num_accts_ever_120_pd double, num_actv_bc_tl double, num_actv_rev_tl double, num_bc_sats double, num_bc_tl double, num_il_tl double, num_op_rev_tl double, num_rev_accts double, num_rev_tl_bal_gt_0 double, num_sats double, num_tl_120dpd_2m double, num_tl_30dpd double, num_tl_90g_dpd_24m double, num_tl_op_past_12m double, pct_tl_nvr_dlq double, percent_bc_gt_75 double, pub_rec_bankruptcies double, tax_liens double, tot_hi_cred_lim double, total_bal_ex_mort double, total_bc_limit double, total_il_high_credit_limit double, revol_bal_joint double, sec_app_fico_range_low double, sec_app_fico_range_high double, sec_app_earliest_cr_line string, sec_app_inq_last_6mths double, sec_app_mort_acc double, sec_app_open_acc double, sec_app_revol_util double, sec_app_open_act_il double, sec_app_num_rev_accts double, sec_app_chargeoff_within_12_mths double, sec_app_collections_12_mths_ex_med double, sec_app_mths_since_last_major_derog double, hardship_flag string, hardship_type string, hardship_reason string, hardship_status string, deferral_term string, hardship_amount string, hardship_start_date string, hardship_end_date string, payment_plan_start_date string, hardship_length string, hardship_dpd string, hardship_loan_status string, orig_projected_additional_accrued_interest string, hardship_payoff_balance_amount string, hardship_last_payment_amount string, disbursement_method string, debt_settlement_flag string, debt_settlement_flag_date string, settlement_status string, settlement_date string, settlement_amount string, settlement_percentage string, settlement_ter string "
    return schema

def read_data(spark, env):
    env_conf = get_app_config(env)
    file_path = env_conf['lending_club.file.path']
    return spark.read.format('csv')\
            .option('header' , 'true').schema(get_schema())\
            .load(file_path)

